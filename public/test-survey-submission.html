<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Survey Submission Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }
        .code {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            margin-top: 10px;
            border: 1px solid #ddd;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            margin-right: 10px;
        }
        button:hover {
            background: #45a049;
        }
        .status {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 3px;
            color: white;
            font-size: 12px;
            margin-left: 10px;
        }
        .status.ok { background: #4CAF50; }
        .status.warning { background: #ff9800; }
        .status.error { background: #f44336; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ ì„¤ë¬¸ì¡°ì‚¬ ì œì¶œ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="test-section">
            <h2>ë¬¸ì œ ë¶„ì„</h2>
            <p><strong>ID 26ì˜ ê²½ìš°:</strong> 25ê°œ ë¬¸í•­ ì¤‘ ë§ˆì§€ë§‰ ë¬¸í•­(ì¸ë±ìŠ¤ 24)ë§Œ ì €ì¥ë¨</p>
            <p><strong>ì›ì¸:</strong> í˜ì´ì§€ë„¤ì´ì…˜ìœ¼ë¡œ ì¸í•´ í˜„ì¬ ë³´ì´ëŠ” í˜ì´ì§€ì˜ inputë§Œ formì— í¬í•¨ë¨</p>
            <p><strong>í•´ê²°ì±…:</strong> ëª¨ë“  ì‘ë‹µì„ hidden inputìœ¼ë¡œ ì¶”ê°€í•˜ì—¬ form ì œì¶œ ì‹œ í¬í•¨</p>
        </div>
        
        <div class="test-section">
            <h2>í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸</h2>
            <button onclick="simulateFullSurvey()">ì „ì²´ ì„¤ë¬¸ ì‹œë®¬ë ˆì´ì…˜</button>
            <button onclick="checkFormInputs()">Form Inputs í™•ì¸</button>
            <button onclick="clearTestData()">í…ŒìŠ¤íŠ¸ ë°ì´í„° ì´ˆê¸°í™”</button>
            
            <div class="code" id="testScript">
// ì „ì²´ ì„¤ë¬¸ ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜
function simulateFullSurvey() {
    // ì„¤ë¬¸ í˜ì´ì§€ë¡œ ì´ë™ í›„ ì½˜ì†”ì—ì„œ ì‹¤í–‰
    const script = `
// Alpine ì»´í¬ë„ŒíŠ¸ ì°¾ê¸°
const component = document.querySelector('[x-data]').__x;

// ì„¤ë¬¸ ì‹œì‘
component.$data.selectedSurvey = 0;
component.$data.showQuestions = true;
component.$data.analysisType = 'simple';

// ëª¨ë“  ë¬¸í•­ì— ëŒ€í•´ ì‘ë‹µ ìƒì„± (25ê°œ ë¬¸í•­)
for (let i = 0; i < 25; i++) {
    // ëœë¤í•˜ê²Œ 0-4 ì¤‘ ì„ íƒ
    component.$data.responses[i] = Math.floor(Math.random() * 5);
}

// í˜„ì¬ ìƒíƒœ í™•ì¸
console.log('Total responses:', Object.keys(component.$data.responses).length);
console.log('Responses:', component.$data.responses);

// ë§ˆì§€ë§‰ í˜ì´ì§€ë¡œ ì´ë™
const totalPages = Math.ceil(25 / 3);
component.$data.currentPage = totalPages - 1;
component.$data.maxReachedPage = totalPages - 1;

// Formì— hidden inputs í™•ì¸
setTimeout(() => {
    const form = document.querySelector('form[method="POST"]');
    const hiddenInputs = form.querySelectorAll('input[type="hidden"][name^="responses"]');
    console.log('Hidden response inputs:', hiddenInputs.length);
    
    hiddenInputs.forEach((input, idx) => {
        console.log(\`Hidden input \${idx}: name=\${input.name}, value=\${input.value}\`);
    });
    
    // ì œì¶œ ì¤€ë¹„ í™•ì¸
    const allAnswered = component.$data.surveys[component.$data.selectedSurvey].questions.every((q, idx) => 
        component.$data.responses.hasOwnProperty(idx)
    );
    console.log('All questions answered:', allAnswered);
    
    if (allAnswered) {
        console.log('âœ… Ready to submit! All 25 questions have responses.');
    } else {
        console.log('âŒ Not ready. Some questions are missing responses.');
    }
}, 1000);
`;
    return script;
}
            </div>
        </div>
        
        <div class="test-section">
            <h2>ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>
            <ol>
                <li>âœ… í˜ì´ì§€ë„¤ì´ì…˜ ì ìš© (3ë¬¸í•­ì”© í‘œì‹œ)</li>
                <li>âœ… localStorageì— ì‘ë‹µ ì €ì¥</li>
                <li>âœ… ëª¨ë“  í˜ì´ì§€ íƒìƒ‰ í›„ ì‘ë‹µ í™•ì¸</li>
                <li>âœ… Hidden inputs ìƒì„± í™•ì¸</li>
                <li>âœ… Form ì œì¶œ ì‹œ ëª¨ë“  ì‘ë‹µ í¬í•¨</li>
            </ol>
        </div>
        
        <div id="result"></div>
    </div>

    <script>
        function simulateFullSurvey() {
            const script = `
// ========================================
// ì „ì²´ ì„¤ë¬¸ ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸
// ========================================

// Alpine ì»´í¬ë„ŒíŠ¸ ì°¾ê¸°
const component = document.querySelector('[x-data]').__x;

// ì„¤ë¬¸ ì‹œì‘
component.$data.selectedSurvey = 0;
component.$data.showQuestions = true;
component.$data.analysisType = 'simple';

// ëª¨ë“  ë¬¸í•­ì— ëŒ€í•´ ì‘ë‹µ ìƒì„± (25ê°œ ë¬¸í•­)
for (let i = 0; i < 25; i++) {
    // ëª¨ë“  ë¬¸í•­ì— 3ë²ˆ ì„ íƒ (ë³´í†µ ìˆìŒ)
    component.$data.responses[i] = 2;
}

// ë§ˆì§€ë§‰ í˜ì´ì§€ë¡œ ì´ë™
const totalPages = Math.ceil(25 / 3);
component.$data.currentPage = totalPages - 1;
component.$data.maxReachedPage = totalPages - 1;

// ìƒíƒœ í™•ì¸
console.log('========================================');
console.log('ì„¤ë¬¸ ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜ ì™„ë£Œ');
console.log('========================================');
console.log('ì´ ì‘ë‹µ ìˆ˜:', Object.keys(component.$data.responses).length);
console.log('í˜„ì¬ í˜ì´ì§€:', component.$data.currentPage + 1, '/', totalPages);
console.log('');

// Form ê²€ì¦
setTimeout(() => {
    const form = document.querySelector('form[method="POST"]');
    const hiddenInputs = form.querySelectorAll('input[type="hidden"][name^="responses"]');
    const radioInputs = form.querySelectorAll('input[type="radio"][name^="responses"]:checked');
    
    console.log('Form ì…ë ¥ ìƒíƒœ:');
    console.log('- Hidden inputs:', hiddenInputs.length);
    console.log('- Radio inputs (checked):', radioInputs.length);
    console.log('- ì´ ì…ë ¥:', hiddenInputs.length + radioInputs.length);
    console.log('');
    
    // ì œì¶œ ê°€ëŠ¥ ì—¬ë¶€
    const allAnswered = Object.keys(component.$data.responses).length === 25;
    if (allAnswered) {
        console.log('âœ… ì œì¶œ ì¤€ë¹„ ì™„ë£Œ! 25ê°œ ë¬¸í•­ ëª¨ë‘ ì‘ë‹µë¨');
        console.log('');
        console.log('ì œì¶œí•˜ë ¤ë©´:');
        console.log('1. "ì„¤ë¬¸ ì™„ë£Œí•˜ê¸°" ë²„íŠ¼ í´ë¦­');
        console.log('2. ë˜ëŠ” ì½˜ì†”ì—ì„œ: document.querySelector(\\'button[type="submit"]\\').click()');
    } else {
        console.log('âŒ ì¼ë¶€ ë¬¸í•­ ë¯¸ì‘ë‹µ');
    }
}, 500);
`;
            
            navigator.clipboard.writeText(script).then(() => {
                document.getElementById('result').innerHTML = `
                    <div class="test-section">
                        <span class="status ok">SUCCESS</span>
                        <strong>ìŠ¤í¬ë¦½íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</strong>
                        <ol style="margin-top: 10px;">
                            <li>https://ai-med.co.kr/surveys í˜ì´ì§€ ì—´ê¸°</li>
                            <li>F12ë¡œ ê°œë°œì ë„êµ¬ ì—´ê¸°</li>
                            <li>Consoleì—ì„œ Ctrl+Vë¡œ ë¶™ì—¬ë„£ê¸°</li>
                            <li>Enterë¡œ ì‹¤í–‰</li>
                            <li>ê²°ê³¼ í™•ì¸ í›„ "ì„¤ë¬¸ ì™„ë£Œí•˜ê¸°" í´ë¦­</li>
                        </ol>
                    </div>
                `;
            });
        }
        
        function checkFormInputs() {
            const script = `
// Form inputs í™•ì¸
const form = document.querySelector('form[method="POST"]');
if (!form) {
    console.log('âŒ Form not found');
    return;
}

const allInputs = form.querySelectorAll('input[name^="responses"]');
const hiddenInputs = form.querySelectorAll('input[type="hidden"][name^="responses"]');
const radioInputs = form.querySelectorAll('input[type="radio"][name^="responses"]');

console.log('=== Form Input Analysis ===');
console.log('Total inputs:', allInputs.length);
console.log('Hidden inputs:', hiddenInputs.length);
console.log('Radio inputs:', radioInputs.length);

// ê° inputì˜ nameê³¼ value ì¶œë ¥
const inputMap = new Map();
allInputs.forEach(input => {
    const name = input.name;
    const value = input.value;
    const type = input.type;
    const checked = input.checked;
    
    if (!inputMap.has(name)) {
        inputMap.set(name, []);
    }
    inputMap.get(name).push({ type, value, checked });
});

console.log('\\nInput details:');
inputMap.forEach((inputs, name) => {
    console.log(\`\${name}:\`, inputs);
});
`;
            
            navigator.clipboard.writeText(script).then(() => {
                alert('Form í™•ì¸ ìŠ¤í¬ë¦½íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }
        
        function clearTestData() {
            const keys = [
                'survey_1_responses',
                'survey_1_freq_responses',
                'survey_1_page',
                'survey_1_max_page',
                'survey_1_timestamps'
            ];
            
            keys.forEach(key => {
                localStorage.removeItem(key);
            });
            
            alert('í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }
    </script>
</body>
</html>