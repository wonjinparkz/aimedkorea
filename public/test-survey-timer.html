<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Survey Response Time Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }
        .test-item {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 4px;
            border-left: 4px solid #4CAF50;
        }
        .code {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            margin-top: 10px;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            margin-right: 10px;
        }
        button:hover {
            background: #45a049;
        }
        .status {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 3px;
            color: white;
            font-size: 12px;
            margin-left: 10px;
        }
        .status.ok { background: #4CAF50; }
        .status.warning { background: #ff9800; }
        .status.error { background: #f44336; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ• ì„¤ë¬¸ì¡°ì‚¬ ì‘ë‹µì‹œê°„ ê°€ë“œ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="test-section">
            <h2>í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤</h2>
            
            <div class="test-item">
                <h3>1. ìµœì†Œ ì‘ë‹µì‹œê°„ ì„¤ì •ê°’</h3>
                <p>ë¬¸í•­ë‹¹ ìµœì†Œ ì‘ë‹µì‹œê°„: <strong>1.5ì´ˆ (1500ms)</strong></p>
                <p>3ë¬¸í•­ í˜ì´ì§€ ìµœì†Œ ì‹œê°„: <strong>4.5ì´ˆ (4500ms)</strong></p>
            </div>
            
            <div class="test-item">
                <h3>2. íƒ€ì„ìŠ¤íƒ¬í”„ ë¡œê¹… í™•ì¸</h3>
                <p>ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ë‹¤ìŒ ì •ë³´ê°€ ê¸°ë¡ë˜ëŠ”ì§€ í™•ì¸:</p>
                <div class="code">// í˜ì´ì§€ ì‹œì‘ ì‹œ
[Timer] Page 1 started at: 2025-09-12T07:30:00.000Z

// ë‹¤ìŒ ë²„íŠ¼ í´ë¦­ ì‹œ
[Timer] Page 1 - Time spent: 2000ms, Minimum required: 4500ms
[Timer] Too fast! Need 3 more seconds

// ì •ìƒ ì§„í–‰ ì‹œ
[Timer] Page 1 - Time spent: 5000ms, Minimum required: 4500ms

// ì™„ë£Œ ì‹œ
[Survey Complete] Total timestamps: {
    0: {
        startTime: 1234567890,
        endTime: 1234572390,
        duration: 4500,
        questions: 3
    },
    1: {...},
    ...
}</div>
            </div>
            
            <div class="test-item">
                <h3>3. LocalStorage ì €ì¥ í™•ì¸</h3>
                <button onclick="checkLocalStorage()">LocalStorage í™•ì¸</button>
                <div id="localStorage-result"></div>
            </div>
            
            <div class="test-item">
                <h3>4. ê²½ê³  ë©”ì‹œì§€ í‘œì‹œ</h3>
                <p>ë„ˆë¬´ ë¹ ë¥¸ ì‘ë‹µ ì‹œ ë…¸ë€ìƒ‰ ê²½ê³  ë©”ì‹œì§€ê°€ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸</p>
                <div style="padding: 12px; background: #fff3cd; border: 1px solid #ffc107; border-radius: 4px; margin-top: 10px;">
                    <strong>âš ï¸ ë„ˆë¬´ ë¹¨ë¦¬ ì‘ë‹µí•˜ê³  ìˆìŠµë‹ˆë‹¤</strong><br>
                    <small>ì •í™•í•œ ë¶„ì„ì„ ìœ„í•´ ê° ë¬¸í•­ì„ ì‹ ì¤‘íˆ ì½ê³  ë‹µë³€í•´ì£¼ì„¸ìš”. ìµœì†Œ ì‘ë‹µ ì‹œê°„: ë¬¸í•­ë‹¹ 1.5ì´ˆ</small>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸</h2>
            <button onclick="runValidation()">ê²€ì¦ ì‹¤í–‰</button>
            <button onclick="clearTestData()">í…ŒìŠ¤íŠ¸ ë°ì´í„° ì´ˆê¸°í™”</button>
            
            <div id="validation-result" style="margin-top: 20px;"></div>
        </div>
    </div>

    <script>
        function checkLocalStorage() {
            const keys = ['survey_1_timestamps', 'survey_1_page', 'survey_1_responses'];
            let html = '<h4>LocalStorage ë‚´ìš©:</h4>';
            
            keys.forEach(key => {
                const value = localStorage.getItem(key);
                if (value) {
                    html += `<div class="code">${key}: ${value}</div>`;
                } else {
                    html += `<div class="code">${key}: <span style="color: red;">ì—†ìŒ</span></div>`;
                }
            });
            
            document.getElementById('localStorage-result').innerHTML = html;
        }
        
        function runValidation() {
            const script = `
// ========================================
// ì„¤ë¬¸ì¡°ì‚¬ ì‘ë‹µì‹œê°„ ê°€ë“œ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸
// ========================================
console.clear();
console.log('%c=== RESPONSE TIME GUARD VALIDATION ===', 'color: white; background: #4CAF50; padding: 5px 10px; font-size: 16px;');
console.log('Timestamp:', new Date().toLocaleString('ko-KR'));
console.log('URL:', window.location.href);
console.log('');

// 1. Alpine.js ë°ì´í„° í™•ì¸
console.log('%c[1] ALPINE DATA CHECK', 'color: #2196F3; font-weight: bold; font-size: 14px;');
const alpineComponent = document.querySelector('[x-data]');
if (alpineComponent && alpineComponent.__x) {
    const data = alpineComponent.__x.$data;
    console.log('âœ… Page Start Time:', data.pageStartTime ? new Date(data.pageStartTime).toISOString() : 'Not set');
    console.log('âœ… Current Page:', data.currentPage);
    console.log('âœ… Min Time Per Question:', data.minimumTimePerQuestion + 'ms');
    console.log('âœ… Show Time Warning:', data.showTimeWarning);
    console.log('âœ… Page Timestamps:', data.pageTimestamps);
} else {
    console.log('âŒ Alpine component not found');
}
console.log('');

// 2. LocalStorage íƒ€ì„ìŠ¤íƒ¬í”„ í™•ì¸
console.log('%c[2] LOCALSTORAGE TIMESTAMPS', 'color: #2196F3; font-weight: bold; font-size: 14px;');
const timestampKey = 'survey_1_timestamps';
const savedTimestamps = localStorage.getItem(timestampKey);
if (savedTimestamps) {
    const timestamps = JSON.parse(savedTimestamps);
    console.log('âœ… Saved timestamps found:');
    Object.entries(timestamps).forEach(([page, data]) => {
        const duration = data.duration / 1000;
        const minRequired = (data.questions * 1.5);
        const status = duration >= minRequired ? 'âœ…' : 'âš ï¸';
        console.log(\`  Page \${parseInt(page) + 1}: \${duration.toFixed(1)}s / \${minRequired}s \${status}\`);
    });
} else {
    console.log('âŒ No timestamp data in localStorage');
}
console.log('');

// 3. ê²½ê³  UI ìš”ì†Œ í™•ì¸
console.log('%c[3] WARNING UI ELEMENTS', 'color: #2196F3; font-weight: bold; font-size: 14px;');
const warningElement = document.querySelector('[x-show="showTimeWarning"]');
if (warningElement) {
    const isVisible = window.getComputedStyle(warningElement).display !== 'none';
    console.log(isVisible ? 'âš ï¸ Warning is currently visible' : 'âœ… Warning is hidden');
} else {
    console.log('âŒ Warning element not found in DOM');
}
console.log('');

// 4. Summary
console.log('%c[SUMMARY]', 'color: white; background: #4CAF50; padding: 3px 8px; font-size: 14px;');
console.log('Response Time Guard: ACTIVE');
console.log('Minimum Time: 1.5s per question');
console.log('Timestamp Logging: ENABLED');
console.log('Warning System: READY');
console.log('');
console.log('%cê²€ì¦ ì™„ë£Œ!', 'color: #4CAF50; font-weight: bold;');
`;
            
            // í´ë¦½ë³´ë“œì— ë³µì‚¬
            navigator.clipboard.writeText(script).then(() => {
                document.getElementById('validation-result').innerHTML = `
                    <div class="test-item">
                        <span class="status ok">SUCCESS</span>
                        <strong>ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</strong>
                        <ol style="margin-top: 10px;">
                            <li>ì„¤ë¬¸ì¡°ì‚¬ í˜ì´ì§€(https://ai-med.co.kr/surveys)ë¡œ ì´ë™</li>
                            <li>F12ë¥¼ ëˆŒëŸ¬ ê°œë°œì ë„êµ¬ ì—´ê¸°</li>
                            <li>Console íƒ­ì—ì„œ Ctrl+Vë¡œ ë¶™ì—¬ë„£ê¸°</li>
                            <li>Enterë¡œ ì‹¤í–‰í•˜ì—¬ ê²°ê³¼ í™•ì¸</li>
                        </ol>
                    </div>
                `;
            }).catch(() => {
                alert('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨. ì½˜ì†”ì—ì„œ ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•˜ì„¸ìš”.');
                console.log(script);
            });
        }
        
        function clearTestData() {
            const keys = [
                'survey_1_timestamps',
                'survey_1_responses', 
                'survey_1_freq_responses',
                'survey_1_page',
                'survey_1_max_page'
            ];
            
            keys.forEach(key => {
                localStorage.removeItem(key);
            });
            
            alert('í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            checkLocalStorage();
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ LocalStorage í™•ì¸
        window.addEventListener('load', () => {
            checkLocalStorage();
        });
    </script>
</body>
</html>